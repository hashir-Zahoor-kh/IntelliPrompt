# ADR 0003: PTY4J for Terminal Control

## Status

Accepted

## Context

IntelliPrompt needs to intercept and analyze terminal commands in real-time. This requires pseudo-terminal (PTY) manipulation.

## Decision

We will use pty4j library for cross-platform PTY control.

## Rationale

### Pros
- **Cross-Platform**: Works on Linux, macOS, Windows (via WinPTY/ConPTY)
- **Battle-Tested**: Used by IntelliJ IDEA, JetBrains IDEs
- **Rich API**: Full PTY lifecycle control
- **Active Maintenance**: Regular updates

### Cons
- Native dependencies (bundled)
- Windows support more complex
- Limited documentation

## Alternatives Considered

1. **JNI Custom Solution**: Too much maintenance burden
2. **Expect-like Tools**: Not suitable for interactive shells
3. **Process.exec()**: Insufficient control over TTY

## Implementation

```java
PtyProcess pty = PtyProcessBuilder.newBuilder()
    .setCommand(new String[]{"/bin/bash"})
    .start();

// Intercept and analyze
OutputStream out = pty.getOutputStream();
InputStream in = pty.getInputStream();
```

## Consequences

- Native library packaging complexity
- Must handle platform-specific PTY differences
- Excellent terminal control capabilities
- Foundation for command interception
